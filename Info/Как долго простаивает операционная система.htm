<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3c.org/TR/1999/REC-html401-19991224/loose.dtd">
<!-- saved from url=(0033)http://netcode.ru/cpp/?artID=5178 -->
<HTML xmlns="http://www.w3.org/1999/xhtml"><HEAD><TITLE>Как долго простаивает операционная система. / Мышь / Система. Общее Официальный сайт справочников World C++, World C#, ASM World</TITLE>
<META http-equiv=Content-Type content="text/html; charset=utf-8"><LINK 
href="Как долго простаивает операционная система.files/styles.css" type=text/css 
rel=stylesheet>
<STYLE type=text/css>.smalltxt {
	FONT-SIZE: 11px; LINE-HEIGHT: 13px; FONT-FAMILY: Verdana, Arial, Helvetica, sans-serif; TEXT-DECORATION: none
}
.errortext {
	FONT-WEIGHT: bold; FONT-SIZE: 10pt; COLOR: red; FONT-FAMILY: Arial, Helvetica, sans-serif
}
.notetext {
	FONT-WEIGHT: bold; FONT-SIZE: 12px; COLOR: green; FONT-FAMILY: Verdana,Arial,Helvetica,sans-serif
}
.filteron {
	COLOR: #ff0000
}
.filteroff {
	COLOR: #1c7729
}
.tablebodylink {
	FONT-SIZE: 12px; FONT-FAMILY: Arial, Helvetica, sans-serif; TEXT-DECORATION: none
}
A.tablebodylink:hover {
	TEXT-DECORATION: underline
}
.textmain {
	FONT-SIZE: 12px; LINE-HEIGHT: 15px; FONT-FAMILY: Verdana, Arial, Helvetica, sans-serif; TEXT-DECORATION: none
}
INPUT.typeinput {
	FONT-SIZE: 12px; BACKGROUND-COLOR: #ffffff
}
INPUT.typeinput2 {
	FONT-SIZE: 12px; WIDTH: 100%; BACKGROUND-COLOR: #ffffff
}
.navchain {
	FONT-SIZE: 12px; COLOR: #1f5887; FONT-FAMILY: Arial,Helvetica
}
.required {
	COLOR: red
}
.pointed {
	COLOR: green
}
.pointed2 {
	COLOR: blue
}
</STYLE>

<META content="MSHTML 6.00.2900.2180" name=GENERATOR></HEAD>
<BODY>
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0 valign="top">
  <TBODY>
  <TR>
    <TD vAlign=top width=0%><A href="http://netcode.ru/"><IMG height=104 
      src="Как долго простаивает операционная система.files/top_01_.gif" 
      width=111 border=0></A></TD>
    <TD vAlign=top width=0%><A href="http://netcode.ru/"><IMG height=104 
      src="Как долго простаивает операционная система.files/top_02.gif" 
      width=176 border=0></A></TD>
    <TD vAlign=top width="100%">
      <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0 valign="top">
        <TBODY>
        <TR>
          <TD vAlign=top>
            <TABLE 
            style="BACKGROUND-IMAGE: url(http://netcode.ru/templates/netcode/images/top_menu_background.gif)" 
            cellSpacing=0 cellPadding=0 width="100%" bgColor=#6262a3 border=0>
              <TBODY>
              <TR>
                <TD 
                style="PADDING-RIGHT: 7px; PADDING-LEFT: 2px; PADDING-BOTTOM: 2px" 
                vAlign=center width=0%><A class=topmenu 
                  href="http://netcode.ru/?lang=cpp">C++</A></TD>
                <TD vAlign=center width=0%><IMG height=31 alt=C++ 
                  src="Как долго простаивает операционная система.files/top_menu_separator.gif" 
                  width=2 border=0></TD><!-- <td valign="middle" width="0%" style="padding-left:7px; padding-right:7px; padding-bottom:2px"><a href="http://netcode.ru/?lang=cs" class="topmenu">C#</a></td>
         <td valign="middle" width="0%"><img src="http://netcode.ru/templates/netcode/images/top_menu_separator.gif" width="2" height="31" border="0" alt="C#"></td> -->
                <TD 
                style="PADDING-RIGHT: 7px; PADDING-LEFT: 7px; PADDING-BOTTOM: 2px" 
                vAlign=center width=0%><A class=topmenu 
                  href="http://netcode.ru/?lang=dotnet"><NOBR>.NET</NOBR></A></TD>
                <TD vAlign=center width=0%><IMG height=31 alt=.NET 
                  src="Как долго простаивает операционная система.files/top_menu_separator.gif" 
                  width=2 border=0></TD>
                <TD 
                style="PADDING-RIGHT: 7px; PADDING-LEFT: 7px; PADDING-BOTTOM: 2px" 
                vAlign=center width=0%><A class=topmenu 
                  href="http://netcode.ru/?lang=asm">ASM</A></TD>
                <TD vAlign=center width=0%><IMG height=31 alt=ASM 
                  src="Как долго простаивает операционная система.files/top_menu_separator.gif" 
                  width=2 border=0></TD>
                <TD 
                style="PADDING-RIGHT: 7px; PADDING-LEFT: 7px; PADDING-BOTTOM: 2px" 
                vAlign=center width=0%><A class=topmenu 
                  title="Разработка драйверов режима ядра" 
                  href="http://rootkits.ru/">Kernel</A></TD>
                <TD vAlign=center width=0%><IMG height=31 
                  alt="Разработка драйверов режима ядра" 
                  src="Как долго простаивает операционная система.files/top_menu_separator.gif" 
                  width=2 border=0></TD>
                <TD 
                style="PADDING-RIGHT: 7px; PADDING-LEFT: 7px; PADDING-BOTTOM: 2px" 
                vAlign=center width=0%><A class=topmenu 
                  href="http://netcode.ru/download/">Скачать</A></TD>
                <TD vAlign=center width=0%><IMG height=31 alt=Скачать 
                  src="Как долго простаивает операционная система.files/top_menu_separator.gif" 
                  width=2 border=0></TD>
                <TD 
                style="PADDING-RIGHT: 7px; PADDING-LEFT: 7px; PADDING-BOTTOM: 2px" 
                vAlign=center width=0%><A class=topmenu 
                  href="http://forum.rootkits.ru/">Форум</A></TD>
                <TD vAlign=center width=0%><IMG height=31 alt=Форум 
                  src="Как долго простаивает операционная система.files/top_menu_separator.gif" 
                  width=2 border=0></TD>
                <TD 
                style="PADDING-RIGHT: 7px; PADDING-LEFT: 7px; PADDING-BOTTOM: 2px" 
                vAlign=center width=0%><A class=topmenu 
                  href="http://netcode.ru/search/">Поиск</A></TD>
                <TD vAlign=center width=0%><IMG height=31 alt=Поиск 
                  src="Как долго простаивает операционная система.files/top_menu_separator.gif" 
                  width=2 border=0></TD>
                <TD 
                style="PADDING-RIGHT: 7px; PADDING-LEFT: 7px; PADDING-BOTTOM: 2px" 
                vAlign=center width=0%><A class=topmenu 
                  href="http://netcode.ru/hosting/">Хостинг</A></TD>
                <TD vAlign=center width=0%><IMG height=31 alt=Хостинг 
                  src="Как долго простаивает операционная система.files/top_menu_separator.gif" 
                  width=2 border=0></TD>
                <TD vAlign=center width="100%"><FONT 
                  class=topmenu>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
        <TR>
          <TD 
          style="BACKGROUND-IMAGE: url(http://netcode.ru/templates/netcode/images/top_menu_bottom.gif); HEIGHT: 5px" 
          vAlign=top><IMG height=5 
            src="Как долго простаивает операционная система.files/1.gif" width=1 
            border=0></TD></TR></TBODY></TABLE>
      <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0 valign="top">
        <TBODY>
        <TR>
          <TD vAlign=top width=0%><IMG height=67 alt="" 
            src="Как долго простаивает операционная система.files/top_03.gif" 
            width=106 border=0></TD>
          <TD 
          style="PADDING-RIGHT: 10px; BACKGROUND-IMAGE: url(http://netcode.ru/templates/netcode/images/top_gradient.gif)" 
          vAlign=top align=right width="100%">
            <DIV>
            <DIV style="Z-INDEX: 100; POSITION: absolute"><IMG height=60 alt="" 
            src="Как долго простаивает операционная система.files/1a.gif" 
            width=468 border=0></DIV><IMG height=60 alt="" 
            src="Как долго простаивает операционная система.files/banner.gif" 
            width=468 border=0> </DIV></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE>
<TABLE id=Table_06 height=193 cellSpacing=0 cellPadding=0 width=1000 border=0>
  <TBODY>
  <TR>
    <TD width=1000 colSpan=7 height=5><IMG height=5 alt="" 
      src="Как долго простаивает операционная система.files/spacer.gif" 
      width=1000></TD></TR>
  <TR>
    <TD width=9 height=188 rowSpan=3><IMG height=188 alt="" 
      src="Как долго простаивает операционная система.files/spacer.gif" 
    width=8></TD>
    <TD colSpan=5><IMG height=24 alt="" 
      src="Как долго простаивает операционная система.files/head.png" 
    width=984></TD>
    <TD width=8 height=188 rowSpan=3><IMG height=188 alt="" 
      src="Как долго простаивает операционная система.files/spacer.gif" 
    width=8></TD></TR>
  <TR>
    <TD vAlign=top width=503 
    background="Как долго простаивает операционная система.files/html_05.gif" 
    height=162 border="0">
      <TABLE id=ctl00_Table2 style="WIDTH: 503px; HEIGHT: 162px" border=0>
        <TBODY>
        <TR>
          <TD vAlign=top align=left>
            <TABLE id=Table3 cellSpacing=3 cellPadding=3 width="100%" 
              border=0><TBODY>
              <TR>
                <TD vAlign=top align=left width=20>&nbsp;&nbsp;<IMG height=12 
                  alt="" 
                  src="Как долго простаивает операционная система.files/punkt.png" 
                  width=12 border=0></TD>
                <TD vAlign=top align=left><FONT color=#5477db><B>24.08.2006 — 
                  <A href="http://netcode.ru/dotnet/?artID=5403">Использование 
                  регулярных выражений для пр...</A></B></FONT><BR>
                  <DIV align=right><FONT color=#5477db><B>Язык: .NET — 
                  ©Microsoft. Пер. Виктор Алексеев...</FONT></DIV></B></TD></TR>
              <TR>
                <TD vAlign=top align=left width=20>&nbsp;&nbsp;<IMG height=12 
                  alt="" 
                  src="Как долго простаивает операционная система.files/punkt.png" 
                  width=12 border=0></TD>
                <TD vAlign=top align=left><FONT color=#5477db><B>20.08.2006 — 
                  <A href="http://netcode.ru/dotnet/?artID=6384">"ASP.NET Atlas" 
                  – AJAX в исполнении Micro...</A></B></FONT><BR>
                  <DIV align=right><FONT color=#5477db><B>Язык: .NET — 
                  ©legigor@mail.ru...</FONT></DIV></B></TD></TR>
              <TR>
                <TD vAlign=top align=left width=20>&nbsp;&nbsp;<IMG height=12 
                  alt="" 
                  src="Как долго простаивает операционная система.files/punkt.png" 
                  width=12 border=0></TD>
                <TD vAlign=top align=left><FONT color=#5477db><B>20.08.2006 — 
                  <A href="http://netcode.ru/cpp/?artID=4884">"Невытесняющая" 
                  Многопоточность...</A></B></FONT><BR>
                  <DIV align=right><FONT color=#5477db><B>Язык: C/C++ — 
                  ©...</FONT></DIV></B></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD>
    <TD width=13 height=162><IMG height=162 alt="" 
      src="Как долго простаивает операционная система.files/spacer.gif" 
    width=13></TD>
    <TD vAlign=top width=227 
    background="Как долго простаивает операционная система.files/html_07.gif" 
    height=162 border="0">
      <TABLE id=ctl00_Table1 style="WIDTH: 224px; HEIGHT: 162px" border=0>
        <TBODY>
        <TR vAlign=top align=left>
          <TD vAlign=top align=left>
            <TABLE id=Table2 cellSpacing=3 cellPadding=3 width="100%" 
              border=0><TBODY>
              <TR>
                <TD vAlign=top align=left width=20>&nbsp;&nbsp;<IMG height=12 
                  alt="" 
                  src="Как долго простаивает операционная система.files/punkt.png" 
                  width=12 border=0></TD>
                <TD vAlign=top align=left><FONT color=#5477db><B>29.12.2006 — 
                  Вышел новый браузер 
            статей!...</B></FONT><BR></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD>
    <TD width=13 height=162><IMG height=162 alt="" 
      src="Как долго простаивает операционная система.files/spacer.gif" 
    width=13></TD>
    <TD vAlign=top width=228 
    background="Как долго простаивает операционная система.files/html_09.gif" 
    height=162 border="0">
      <TABLE id=Table4 cellSpacing=3 cellPadding=3 width="100%" border=0>
        <TBODY>
        <TR>
          <TD vAlign=top align=left colSpan=2>
            <CENTER><FONT color=#5477db><B><A 
            href="http://netcode.ru/hosting/"><FONT 
            color=#7d060f>Хостинг:</FONT><BR>Windows 2003, ASP.NET 2.0<BR><FONT 
            color=#7d060f>бесплатный</FONT> и от 90 руб./мес</A><BR><BR>Служба 
            поддержки хостинга: <BR>8 800 200-11-52<BR>(По России 
            БЕСПЛАТНО!)</B></FONT></CENTER><BR></TD></TR>
        <TR>
          <TD vAlign=top align=right width=24>&nbsp;&nbsp;<IMG height=14 
            alt="" 
            src="Как долго простаивает операционная система.files/mail.png" 
            width=14 border=0></TD>
          <TD vAlign=top align=left><FONT color=#5477db><B><A 
            href="mailto:dotnetfx@mail.ru">Прислать статью</A></B></FONT></TD></TR>
        <TR>
          <TD vAlign=top align=right colSpan=2><FONT 
            color=#5477db><B>ICQ&nbsp;—&nbsp;159585</B></FONT></TD></TR></TBODY></TABLE></TD></TR>
  <TR>
    <TD width=984 colSpan=5 height=2><IMG height=2 alt="" 
      src="Как долго простаивает операционная система.files/spacer.gif" 
      width=984></TD></TR></TBODY></TABLE><BR>
<FORM id=aspnetForm name=aspnetForm action=default.aspx?artID=5178 method=post>
<DIV><INPUT id=__EVENTTARGET type=hidden name=__EVENTTARGET> <INPUT 
id=__EVENTARGUMENT type=hidden name=__EVENTARGUMENT> <INPUT id=__VIEWSTATE 
type=hidden 
value=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 
name=__VIEWSTATE> </DIV>
<SCRIPT type=text/javascript>
<!--
var theForm = document.forms['aspnetForm'];
if (!theForm) {
    theForm = document.aspnetForm;
}
function __doPostBack(eventTarget, eventArgument) {
    if (!theForm.onsubmit || (theForm.onsubmit() != false)) {
        theForm.__EVENTTARGET.value = eventTarget;
        theForm.__EVENTARGUMENT.value = eventArgument;
        theForm.submit();
    }
}
// -->
</SCRIPT>

<DIV>
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
  <TBODY>
  <TR>
    <TD width=0% bgColor=#9b9b9b><IMG height=23 alt="" 
      src="Как долго простаивает операционная система.files/red_vulnerability.gif" 
      width=20 border=0> </TD>
    <TD 
    style="BACKGROUND-IMAGE: url(http://netcode.ru/templates/netcode/images/section_red_background.gif)" 
    width="100%" bgColor=#9b9b9b>
      <H1>&nbsp;<SPAN id=ctl00_ContentPlaceHolder1_TitleLabel>Как долго 
      простаивает операционная система. / Мышь / Система. Общее</SPAN></H1></TD>
    <TD width=0% bgColor=#9b9b9b><IMG height=23 alt="" 
      src="Как долго простаивает операционная система.files/section_red_02.gif" 
      width=22 border=0> </TD></TR></TBODY></TABLE>
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
  <TBODY>
  <TR>
    <TD class=inctable 
    style="PADDING-RIGHT: 12px; PADDING-LEFT: 12px; PADDING-BOTTOM: 5px; PADDING-TOP: 5px">
      <TABLE id=ctl00_ContentPlaceHolder1_ContentTable style="WIDTH: 100%" 
      border=0>
        <TBODY>
        <TR>
          <TD><BR><BR>
            <H3 align=center>Как долго простаивает операционная система.</H3>
            <P>Автор: <A href="http://netcode.ru/cpp/?click=index-235.htm" 
            tppabs="http://www.dilascia.com/">Paul DiLascia</A></P>
            <P><A href="http://netcode.ru/cpp/?click=files/getlastinputinfo.zip" 
            tppabs="/system/getlastinputinfo.zip">Скачать исходник к статье - 21 
            Кб</A> (Компилятор: Visual C++ 6.0)</P>
            <P>Вы задавались когда-нибудь вопросом, как можно определить сколько 
            времени бездействует операционная система ? Или, например, как аська 
            определяет, что пользователя нет за компьютером ? Проще говоря, как 
            определить, сколько времени не трогали мышку или не стучали по 
            клавиатуре ?</P>
            <P>В Windows 2000 для этих целей предусмотрена системная функция 
            GetLastInputInfo, которая заполняет структуру LASTINPUTINFO нужной 
            нам информацией:</P><PRE> LASTINPUTINFO lpi;
 lpi.cbSize = sizeof(lpi);
 GetLastInputInfo(&amp;lpi);
</PRE>
            <P>После вызова GetLastInputInfo, lpi.dwTime содержит количество 
            миллисекунд, прошедших с момента прекращения каких либо действий 
            пользователя. С одной стороны, это то, что нам нужно, но с другой - 
            эта функция доступна только в Windows 2000 - но не в Windows 9x и не 
            в Windows NT 4.0. Надо бы подумать, что в таком случае можно 
            предпринять.</P>
            <P>Наверное, проще всего будет написать свою версию 
            GetLastInputInfo, а именно поставить глобальную ловушку (systemwide 
            hook). Ловушка, это callback-функция, которую Windows вызывает 
            каждый раз, когда случается что-нибудь интересное, например, когда 
            пользователь что-нибудь напечатает на клавиатуре. Универсальной 
            ловушки не существует, однако ловушкой на клавиатуру и ловушкой на 
            мышь мы спокойно сможем перехватить весь пользовательский ввод. 
            Единственное, что может раздражать в таком случае, это то, что 
            ловушки должны жить в DLL.</P>
            <P>Итак, для этой цели я написал простенькую DLL, которую назвал 
            IdleUI и которая имеет всего три функции:</P><PRE> BOOL  IdleUIInit()
 void  IdleUITerm();
 DWORD IdleUIGetLastInputTime();
</PRE>
            <P>Как Вы наверное уже догадались, IdleUIInit служит для 
            инициализации, а IdleUITerm для завершения. Их можно спокойно 
            вызывать из приложения MFC в функциях InitInstance и ExitInstance 
            соответственно. Как только проинициализируется IdleUI, можно вызвать 
            третью функцию IdleUIGetLastInputTime, чтобы получить количество 
            тиков, прошедших с момента последнего пользовательского ввода, как 
            это делает GetLastInputInfo.</P>
            <P>Чтобы протестировать свою DLL, я написал программку TestIdleUI. 
            Она вызывает IdleUIInit и IdleUITerm как описано выше и при этом 
            отображает количество секунд бездействия клавиатуры и мышки.</P><PRE> void CMainFrame::OnPaint()
 {
   CPaintDC dc(this);
   CString s;
   DWORD nsec = (GetTickCount()-
     IdleUIGetLastInputTime())/1000;
   s.Format(
     "No mouse or keyboard input for %d seconds.",nsec);
   CRect rc;
   GetClientRect(&amp;rc);
   dc.DrawText(s, &amp;rc,   
     DT_CENTER|DT_VCENTER|DT_SINGLELINE);
 }
</PRE>
            <P>Как это выглядит, можно посмотреть на рисунке 1. Для обеспечения 
            непрерывности процесса отсчёта, в TestIdleUI используется 
            односекундный таймер, который обновляет клиентскую область каждую 
            секунду.</P><PRE> void CMainFrame::OnTimer(UINT)
 {
   Invalidate();
   UpdateWindow();
 }
</PRE>
            <P>Что может быть проще? Запускаем TestIdleUI и наблюдаем по 
            секундам, как Ваш компьютер бездействует. Достаточно сдвинуть мышку 
            и щёлкнуть по клавиатуре, как счётчик сбросится в ноль.</P>
            <P><IMG height=56 
            src="Как долго простаивает операционная система.files/getlastinputinfo.gif" 
            width=300 tppabs="/system/getlastinputinfo.gif"><B><BR>Рисунок 1 
            TestIdleUI</B></P>
            <P>Как работает IdleUI? Когда Вы вызваете IdleUIInit, то она 
            инсталлирует две ловушки: одну для мышки, а вторую для 
            клавиатуры.</P><PRE> HHOOK g_hHookKbd;
 HHOOK g_hHookMouse;
 g_hHookKbd = SetWindowsHookEx(WH_KEYBOARD,
                               MyKbdHook, 
                               hInst, 0);
 g_hHookMouse = SetWindowsHookEx(WH_MOUSE,
                                 MyMouseHook, 
                                 hInst, 0);
</PRE>
            <P>Теперь если пользователь двигает мышку или нажимает клавишу на 
            клавиатуре, Windows вызывает одну из этих ловушек и соответствующую 
            ей функцию, которая записывает время:</P><PRE> LRESULT CALLBACK MyMouseHook(int code, 
                              WPARAM wp, 
                              LPARAM lp)
 {
   if (code==HC_ACTION) {
     // уведомляем счётчик тиков
     g_dwLastInputTick = GetTickCount();
   }
   return ::CallNextHookEx(g_hHookMouse,
                           code, wp, lp);
 }
</PRE>
            <P>Аналогичная операция делается для MyKbdHook. 
            IdleUIGetLastInputTime возвращает g_dwLastInputTick, а IdleUITerm 
            деинсталлирует обе ловушки.</P>
            <P>Есть только одна тонкость. Обычно, когда Вы создаёте DLL, то 
            компилятор помечает статические данные как нерасшаренные 
            (nonshared), что означает, что каждый процесс, который вызывает DLL 
            получает свою собственную копию данных - в данном случае g_hHookKbd, 
            g_hHookMouse, и g_dwLastInputTick. Но нам-то нужен один и только 
            один экземпляр этих данных. Поэтому необходимо сделать данные 
            доступными. Для этого необходимо поместить их в специальный сегмент, 
            который помен как доступный (shared). В коде это выглялит так:</P><PRE> #pragma data_seg (".IdleUI") // или любое другое имя
 HHOOK g_hHookKbd = NULL;
 HHOOK g_hHookMouse = NULL;
 DWORD g_dwLastInputTick = 0;
 #pragma data_seg ()
</PRE>
            <P>Этот код указывает компилятору, что три переменные необходимо 
            поместить в сегмент данных с именем .IdleUI. Затем необходимо 
            добавить следующую строчку в IdleUI.def, сделав тем самым сегмент 
            расшаренным (доступным):</P><PRE> // в IdleUI.def
 SECTIONS .IdleUI READ WRITE SHARED
</PRE>
            <P>Вот собственно и всё. 
  Удачи!</P><BR><BR></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE><BR>
<TABLE 
style="BORDER-RIGHT: #507cd1 1px solid; BORDER-TOP: #507cd1 1px solid; BORDER-LEFT: #507cd1 1px solid; BORDER-BOTTOM: #507cd1 1px solid" 
cellSpacing=0 cellPadding=0 width="100%" border=0>
  <TBODY>
  <TR>
    <TD style="FONT-WEIGHT: bold; COLOR: #ffffff; BACKGROUND-COLOR: #507cd1" 
    vAlign=center colSpan=3>&nbsp;Похожие статьи, найденные по слову «<SPAN 
      id=ctl00_ContentPlaceHolder1_w1_Label>долго</SPAN>»</TD></TR>
  <TR>
    <TD style="BACKGROUND-COLOR: #507cd1" colSpan=3>
      <DIV>
      <TABLE id=ctl00_ContentPlaceHolder1_GridView1 
      style="WIDTH: 100%; COLOR: #333333; BORDER-COLLAPSE: collapse" 
      cellSpacing=0 cellPadding=4 align=center border=0>
        <TBODY>
        <TR 
          style="FONT-WEIGHT: bold; COLOR: white; BACKGROUND-COLOR: #507cd1"><TH 
          style="BORDER-TOP-STYLE: none; BORDER-RIGHT-STYLE: none; BORDER-LEFT-STYLE: none; BORDER-BOTTOM-STYLE: none" 
          scope=col align=left><A style="COLOR: white" 
            href="javascript:__doPostBack('ctl00$ContentPlaceHolder1$GridView1','Sort$articles')">Название</A></TH>
          <TH scope=col align=left><A style="COLOR: white" 
            href="javascript:__doPostBack('ctl00$ContentPlaceHolder1$GridView1','Sort$author')">Автор</A></TH></TR>
        <TR style="BACKGROUND-COLOR: #eff3fb">
          <TD 
          style="FONT-WEIGHT: bold; WIDTH: 500px; COLOR: #4f59a5; TEXT-DECORATION: underline" 
          vAlign=center><A 
            style="DISPLAY: inline-block; FONT-WEIGHT: bold; WIDTH: 500px; COLOR: #4f59a5" 
            href="http://netcode.ru/cpp/?artID=5178">Как долго простаивает 
            операционная система.</A></TD>
          <TD style="FONT-WEIGHT: bold; WIDTH: 100px; COLOR: #4f59a5" 
          vAlign=center>&nbsp;</TD></TR></TBODY></TABLE></DIV></TD></TR>
  <TR>
    <TD colSpan=3></TD></TR></TBODY></TABLE></DIV>
<DIV><INPUT id=__EVENTVALIDATION type=hidden 
value=/wEWAwKHv9jmBAKk04aCCAKts/27AfqGxNWkkIdCWMecbwM7vpuJIwpn 
name=__EVENTVALIDATION> </DIV></FORM></BODY></HTML>
